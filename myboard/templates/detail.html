<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>게시글보기</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f2f2f2;
        }

        h1 {
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            padding: 10px;
            text-align: left;
            border: 1px solid #ccc;
        }

        th {
            background-color: palegoldenrod;
        }

        textarea {
            width: 100%;
            resize: none;
        }

        input[type="text"], textarea {
            padding: 5px;
            background-color: bisque;
        }

        input[type="button"] {
            padding: 5px 10px;
            background-color: #007bff;
            color: #fff;
            border: none;
            cursor: pointer;
        }

        input[type="button"]:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

    <h1>Detail</h1>

    <table border="1">
        <tr>
            <th>작성자</th>
            <td><input type="text" readonly value="{{ dto.myname }}"></td>
        </tr>
        <tr>
            <th>제목</th>
            <td><input type="text" readonly value="{{ dto.mytitle }}"></td>
        </tr>
        <tr>
            <th>내용</th>
            <td><textarea cols="60" rows="10" readonly>{{ dto.mycontent }}</textarea></td>
        </tr>
        <tr>
            <td colspan="2" align="right">
                <input type="button" value="목록" onclick="location.href='/'">
                <input type="button" value="수정" onclick="location.href='{% url 'update' dto.id %}'">
                <input type="button" value="삭제" onclick="location.href='{% url 'delete' dto.id %}'">
            </td>
        </tr>

        <tr>
            
            <th>답글</th>
            {% if not request.session.myname %}
            <td>로그인이 필요합니다</td>
            {% else %}
            <td>
                <textarea id="reply-content" cols="60" rows="1"></textarea>
                <input type="button" value="등록" onclick="submitReply()">
            </td>
            {% endif %}
        </tr>



    </table>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        $.ajaxSetup({
          headers: { "X-CSRFToken": '{{csrf_token}}' }
        });
    </script>

<script>
    function submitReply() {
        var sessionId = "{{ request.session.myname }}"; // Assuming the session ID is passed to the HTML template
        var content = $('#reply-content').val();
        var dateTime = new Date().toISOString();

        console.log(sessionId, content, dateTime);

        // Prepare the data to be sent
        var data = JSON.stringify({
            sessionId: sessionId,
            content: content,
            dateTime: dateTime
        });

        // Make the AJAX request using $.ajax
        $.ajax({
            url: '/reply/',
            type: 'POST',
            contentType: 'application/json',
            data: data,
            success: function(response) {
                alert('Reply submitted successfully!');
                
            },
            error: function(xhr, status, error) {
                // Handle any errors that occurred during the request
                console.error('An error occurred:', error);
            }
        });
    }
</script>







    

</body>
</html>